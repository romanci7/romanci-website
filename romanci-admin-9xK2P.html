<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>ROMANCI Admin</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<style>
body {
  background:#0b0b0b;
  color:#fff;
  font-family:Inter,system-ui;
  margin:0;
}

.container {
  max-width:900px;
  margin:auto;
  padding:40px 20px;
}

h1 {
  color:#d4af37;
  letter-spacing:2px;
}

.login-box, .panel {
  background:#141414;
  padding:30px;
  border-radius:18px;
  box-shadow:0 0 40px rgba(212,175,55,.12);
}

input, button {
  width:100%;
  padding:14px;
  margin-top:12px;
  border-radius:12px;
  border:none;
  font-size:16px;
}

input { background:#1d1d1d; color:white; }

button {
  background:linear-gradient(135deg,#d4af37,#f6e7b5);
  color:black;
  font-weight:700;
  cursor:pointer;
}

.vouch {
  border:1px solid rgba(212,175,55,.3);
  padding:18px;
  border-radius:14px;
  margin-top:15px;
}

.actions button {
  width:auto;
  margin-right:10px;
}
</style>
</head>

<body>

<div class="container">

<h1>ROMANCI ADMIN</h1>

<!-- LOGIN -->
<div class="login-box" id="loginBox">
  <h2>Admin Login</h2>
  <input id="email" placeholder="Admin Email">
  <input id="password" type="password" placeholder="Password">
  <button id="loginBtn">Login</button>
  <p id="error" style="color:red;"></p>
</div>

<!-- PANEL -->
<div class="panel" id="panel" style="display:none;">
  <h2>Pending Vouches</h2>
  <div id="vouches"></div>
  <button onclick="logout()">Logout</button>
</div>

</div>

<script type="module">

// ðŸ”¥ Firebase Imports
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { 
  getAuth,
  signInWithEmailAndPassword,
  onAuthStateChanged,
  signOut
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

import { 
  getFirestore,
  collection,
  query,
  where,
  onSnapshot,
  updateDoc,
  doc
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";


// ðŸ”¥ YOUR CONFIG (already from screenshot)
const firebaseConfig = {
  apiKey: "AIzaSyCT1_NEA_UIu_1dSTgy5awbGQI-7KCvwVo",
  authDomain: "romanci-vouch.firebaseapp.com",
  projectId: "romanci-vouch",
  storageBucket: "romanci-vouch.appspot.com",
  messagingSenderId: "154787033593",
  appId: "1:154787033593:web:24d3185cdedfbaded8d28"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);


// ðŸ” LOGIN
document.getElementById("loginBtn").onclick = () => {

  const email = email.value;
  const password = password.value;

  signInWithEmailAndPassword(auth, email, password)
    .catch(err => {
      document.getElementById("error").innerText = err.message;
    });
};


// ðŸ‘€ AUTH STATE
onAuthStateChanged(auth, user => {

  if(user){
    loginBox.style.display="none";
    panel.style.display="block";
    loadVouches();
  }

});


// ðŸ“¦ LOAD UNAPPROVED
function loadVouches(){

  const q = query(
    collection(db,"vouches"),
    where("approved","==",false)
  );

  onSnapshot(q, snap => {

    vouches.innerHTML="";

    snap.forEach(docSnap => {

      const v = docSnap.data();

      const box = document.createElement("div");
      box.className="vouch";

      box.innerHTML = `
        <b>${v.name}</b><br>
        ${v.message}<br><br>
        <div class="actions">
          <button onclick="approve('${docSnap.id}')">Approve</button>
          <button onclick="reject('${docSnap.id}')">Reject</button>
        </div>
      `;

      vouches.appendChild(box);

    });

  });

}


// âœ… APPROVE
window.approve = async (id)=>{
  await updateDoc(doc(db,"vouches",id),{
    approved:true
  });
};


// âŒ REJECT
window.reject = async (id)=>{
  await updateDoc(doc(db,"vouches",id),{
    approved:false,
    rejected:true
  });
};


// ðŸšª LOGOUT
window.logout = ()=>{
  signOut(auth);
  location.reload();
};

</script>

</body>
</html>
